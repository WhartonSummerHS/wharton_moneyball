<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Module 3: Wrangling Data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">WMA19</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-futbol-o"></span>
     
    Lecture Notes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="module1.html">Module 1</a>
    </li>
    <li>
      <a href="module2.html">Module 2</a>
    </li>
    <li>
      <a href="module3.html">Module 3</a>
    </li>
    <li>
      <a href="module4.html">Module 4</a>
    </li>
    <li>
      <a href="module5.html">Module 5</a>
    </li>
    <li>
      <a href="module6.html">Module 6</a>
    </li>
    <li>
      <a href="module7.html">Module 7</a>
    </li>
    <li>
      <a href="module8.html">Module 8</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-dribbble"></span>
     
    Problem Sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ps0.html">Problem Set 0</a>
    </li>
    <li>
      <a href="ps1.html">Problem Set 1</a>
    </li>
    <li>
      <a href="ps2.html">Problem Set 2</a>
    </li>
    <li>
      <a href="ps3.html">Problem Set 3</a>
    </li>
    <li>
      <a href="ps4.html">Problem Set 4</a>
    </li>
    <li>
      <a href="ps5.html">Problem Set 5</a>
    </li>
    <li>
      <a href="ps6.html">Problem Set 6</a>
    </li>
    <li>
      <a href="ps7.html">Problem Set 7</a>
    </li>
    <li>
      <a href="ps8.html">Problem Set 8</a>
    </li>
  </ul>
</li>
<li>
  <a href="project_info.html">
    <span class="fa fa-money"></span>
     
    Projects
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Module 3: Wrangling Data</h1>

</div>


<!--
Wrangling Data with dplyr

  1. Arrange
  2. Filter
  3. Mutate
  4. Summarise
  5. Select
-->
<p>We will be using tools containined in the dplyr() package, which is already loaded when we load the tidyverse. There are five main functions in dplyr corresponding to the most common things you’ll want to do with your data. We will learn each of these.</p>
<ul>
<li>Reorder the rows with <code>arrange()</code></li>
<li>Identify observations satisfying certain conditions with <code>filter()</code></li>
<li>Creating new variables that are functions of existing variables with <code>mutate()</code></li>
<li>Picking a subset of variables by names with <code>select()</code></li>
<li>Generating simple summaries of the data with <code>summarise()</code></li>
</ul>
<div id="arranging-data" class="section level3">
<h3>Arranging Data</h3>
<p>In <a href="module2.html">Module 2</a>, we looked at NBA shooting data over 20 seasons. When we visualized this data, we noticed that there were some players who took very few of a certain type of shot. In order to verify this, we could try sorting our tbl according to the number of field goals attemped. We’ll start by loading the NBA shooting data again into a tbl called <code>raw_shooting</code> (the reasons for this naming convention will be clearer soon).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">library</span>(tidyverse)
&gt;<span class="st"> </span>raw_shooting &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;data/nba_shooting.csv&quot;</span>)
Parsed with column specification:
<span class="kw">cols</span>(
  <span class="dt">PLAYER =</span> <span class="kw">col_character</span>(),
  <span class="dt">SEASON =</span> <span class="kw">col_integer</span>(),
  <span class="dt">FGM =</span> <span class="kw">col_integer</span>(),
  <span class="dt">FGA =</span> <span class="kw">col_integer</span>(),
  <span class="dt">TPM =</span> <span class="kw">col_integer</span>(),
  <span class="dt">TPA =</span> <span class="kw">col_integer</span>(),
  <span class="dt">FTM =</span> <span class="kw">col_integer</span>(),
  <span class="dt">FTA =</span> <span class="kw">col_integer</span>(),
  <span class="dt">FGP =</span> <span class="kw">col_double</span>(),
  <span class="dt">TPP =</span> <span class="kw">col_double</span>(),
  <span class="dt">FTP =</span> <span class="kw">col_double</span>()
)</code></pre></div>
<p>The <code>arrange()</code> function works by taking a tbl and a set of column names and sorting the data according to the values in these columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">arrange</span>(raw_shooting, FGA)
<span class="co"># A tibble: 7,447 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Dajuan Wag…   <span class="dv">2007</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">1</span>         <span class="dv">1</span>   <span class="fl">0.5</span>
 <span class="dv">2</span> Tyson Whee…   <span class="dv">1999</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">1</span>         <span class="dv">1</span>   <span class="fl">0.5</span>
 <span class="dv">3</span> Alvin Will…   <span class="dv">2007</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">4</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="fl">0.5</span>
 <span class="dv">4</span> Donald Whi…   <span class="dv">1998</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">2</span> <span class="fl">0.5</span>       <span class="dv">0</span>   <span class="dv">0</span>  
 <span class="dv">5</span> Mustafa Sh…   <span class="dv">2014</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="fl">0.5</span>
 <span class="dv">6</span> John Lucas…   <span class="dv">2011</span>     <span class="dv">1</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">2</span> <span class="fl">0.333</span>     <span class="dv">0</span>   <span class="dv">0</span>  
 <span class="dv">7</span> Roger Powe…   <span class="dv">2007</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="dv">1</span>  
 <span class="dv">8</span> Alvin Will…   <span class="dv">2006</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="fl">0.5</span>
 <span class="dv">9</span> Rusty LaRue   <span class="dv">2004</span>     <span class="dv">1</span>     <span class="dv">3</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="fl">0.333</span>     <span class="dv">1</span>   <span class="fl">0.5</span>
<span class="dv">10</span> Dell Demps    <span class="dv">1997</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="dv">1</span>  
<span class="co"># … with 7,437 more rows</span></code></pre></div>
<p>We see now that there were two players who attempted only one field goal. We could instead sort the data according to FGA but in descending order, using <code>desc()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">arrange</span>(raw_shooting, <span class="kw">desc</span>(FGA))
<span class="co"># A tibble: 7,447 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Kobe Bryant   <span class="dv">2006</span>   <span class="dv">978</span>  <span class="dv">2173</span>   <span class="dv">180</span>   <span class="dv">518</span>   <span class="dv">696</span>   <span class="dv">819</span> <span class="fl">0.450</span> <span class="fl">0.347</span> <span class="fl">0.850</span>
 <span class="dv">2</span> Allen Iver…   <span class="dv">2003</span>   <span class="dv">804</span>  <span class="dv">1940</span>    <span class="dv">84</span>   <span class="dv">303</span>   <span class="dv">570</span>   <span class="dv">736</span> <span class="fl">0.414</span> <span class="fl">0.277</span> <span class="fl">0.774</span>
 <span class="dv">3</span> Jerry Stac…   <span class="dv">2001</span>   <span class="dv">774</span>  <span class="dv">1927</span>   <span class="dv">166</span>   <span class="dv">473</span>   <span class="dv">666</span>   <span class="dv">810</span> <span class="fl">0.402</span> <span class="fl">0.351</span> <span class="fl">0.822</span>
 <span class="dv">4</span> Kobe Bryant   <span class="dv">2003</span>   <span class="dv">868</span>  <span class="dv">1924</span>   <span class="dv">124</span>   <span class="dv">324</span>   <span class="dv">601</span>   <span class="dv">713</span> <span class="fl">0.451</span> <span class="fl">0.383</span> <span class="fl">0.843</span>
 <span class="dv">5</span> Michael Jo…   <span class="dv">1998</span>   <span class="dv">881</span>  <span class="dv">1893</span>    <span class="dv">30</span>   <span class="dv">126</span>   <span class="dv">565</span>   <span class="dv">721</span> <span class="fl">0.465</span> <span class="fl">0.238</span> <span class="fl">0.784</span>
 <span class="dv">6</span> Michael Jo…   <span class="dv">1997</span>   <span class="dv">920</span>  <span class="dv">1892</span>   <span class="dv">111</span>   <span class="dv">297</span>   <span class="dv">480</span>   <span class="dv">576</span> <span class="fl">0.486</span> <span class="fl">0.374</span> <span class="fl">0.833</span>
 <span class="dv">7</span> LeBron Jam…   <span class="dv">2006</span>   <span class="dv">875</span>  <span class="dv">1823</span>   <span class="dv">127</span>   <span class="dv">379</span>   <span class="dv">601</span>   <span class="dv">814</span> <span class="fl">0.480</span> <span class="fl">0.335</span> <span class="fl">0.738</span>
 <span class="dv">8</span> Allen Iver…   <span class="dv">2006</span>   <span class="dv">815</span>  <span class="dv">1822</span>    <span class="dv">72</span>   <span class="dv">223</span>   <span class="dv">675</span>   <span class="dv">829</span> <span class="fl">0.447</span> <span class="fl">0.323</span> <span class="fl">0.814</span>
 <span class="dv">9</span> Allen Iver…   <span class="dv">2005</span>   <span class="dv">771</span>  <span class="dv">1818</span>   <span class="dv">104</span>   <span class="dv">338</span>   <span class="dv">656</span>   <span class="dv">786</span> <span class="fl">0.424</span> <span class="fl">0.308</span> <span class="fl">0.835</span>
<span class="dv">10</span> Tracy McGr…   <span class="dv">2003</span>   <span class="dv">829</span>  <span class="dv">1813</span>   <span class="dv">173</span>   <span class="dv">448</span>   <span class="dv">576</span>   <span class="dv">726</span> <span class="fl">0.457</span> <span class="fl">0.386</span> <span class="fl">0.793</span>
<span class="co"># … with 7,437 more rows</span></code></pre></div>
<p>When we specify more than one column, <code>arrange()</code> uses each additional column name to break ties in the values of preceding columns</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">arrange</span>(raw_shooting, FGA, TPA, FTA)
<span class="co"># A tibble: 7,447 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Dajuan Wag…   <span class="dv">2007</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">1</span>         <span class="dv">1</span>   <span class="fl">0.5</span>
 <span class="dv">2</span> Tyson Whee…   <span class="dv">1999</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">1</span>         <span class="dv">1</span>   <span class="fl">0.5</span>
 <span class="dv">3</span> Donald Whi…   <span class="dv">1998</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">2</span> <span class="fl">0.5</span>       <span class="dv">0</span>   <span class="dv">0</span>  
 <span class="dv">4</span> Alvin Will…   <span class="dv">2007</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">4</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="fl">0.5</span>
 <span class="dv">5</span> Mustafa Sh…   <span class="dv">2014</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="fl">0.5</span>
 <span class="dv">6</span> John Lucas…   <span class="dv">2011</span>     <span class="dv">1</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">2</span> <span class="fl">0.333</span>     <span class="dv">0</span>   <span class="dv">0</span>  
 <span class="dv">7</span> Roger Powe…   <span class="dv">2007</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="dv">1</span>  
 <span class="dv">8</span> Rusty LaRue   <span class="dv">2004</span>     <span class="dv">1</span>     <span class="dv">3</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="fl">0.333</span>     <span class="dv">1</span>   <span class="fl">0.5</span>
 <span class="dv">9</span> Dell Demps    <span class="dv">1997</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="dv">1</span>  
<span class="dv">10</span> Alvin Will…   <span class="dv">2006</span>     <span class="dv">0</span>     <span class="dv">3</span>     <span class="dv">0</span>     <span class="dv">2</span>     <span class="dv">1</span>     <span class="dv">2</span> <span class="dv">0</span>         <span class="dv">0</span>   <span class="fl">0.5</span>
<span class="co"># … with 7,437 more rows</span></code></pre></div>
</div>
<div id="filtering-data" class="section level3">
<h3>Filtering Data</h3>
<p>When we start computing advanced statistics like effective field goal percentage and true shooting percentage, we probably don’t want to consider those players for whom we have very little data. For instance, we probably do not want to include the players who took a very limited number of shots in any one season in our analysis. The function <code>filter()</code> is used to pull out subsets of observations that satisfy some logical condition like “FGA &gt; 100” or “FGA &gt; 100 and FTA &gt; 50”.</p>
<p>To make such comparisons in R, we have the following operators available at our disposal:</p>
<ul>
<li><code>==</code> for “equal to”</li>
<li><code>!=</code> for “not equal to”</li>
<li><code>&lt;</code> and <code>&lt;=</code> for “less than” and “less than or equal to”</li>
<li><code>&gt;</code> and <code>&gt;=</code> for “greater than” and “greater than or equal to”</li>
<li><code>&amp;</code>, <code>|</code>, <code>!</code> for “AND” and “OR” and “NOT” The code below filter out all of the players with at least 100 field goals in a single season</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">filter</span>(raw_shooting, FGA &gt;<span class="st"> </span><span class="dv">100</span>)
<span class="co"># A tibble: 6,295 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Cu…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James Hard…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin Dura…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMarcus C…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBron Jam…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damian Lil…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Anthony Da…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russell We…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar DeRo…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul George   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 6,285 more rows</span></code></pre></div>
<p>When we run this code, you’ll notice that R prints out a tbl with 6,385 rows. However, it has not removed the players with fewer than 100 field goals from the original tbl <code>raw_shooting</code>. In fact, dplyr functions never modify their input but work by creating a copy and modifying that. So if we wanted to be able to use the tbl consisting of just those players with a least 100 field goal attempts, we will need to save this modified copy of <code>raw_shooting</code> as a new tbl. Arranging this new tbl verifies that all observations contained in it have at least 100 field goals attempts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>new_data &lt;-<span class="st"> </span><span class="kw">filter</span>(raw_shooting, FGA &gt;=<span class="st"> </span><span class="dv">100</span>)
&gt;<span class="st"> </span><span class="kw">arrange</span>(new_data, FGA)
<span class="co"># A tibble: 6,306 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Jordan Far…   <span class="dv">2016</span>    <span class="dv">42</span>   <span class="dv">100</span>    <span class="dv">16</span>    <span class="dv">45</span>    <span class="dv">10</span>    <span class="dv">10</span>  <span class="fl">0.42</span> <span class="fl">0.356</span> <span class="dv">1</span>    
 <span class="dv">2</span> Jerry Stac…   <span class="dv">2012</span>    <span class="dv">37</span>   <span class="dv">100</span>    <span class="dv">13</span>    <span class="dv">38</span>    <span class="dv">21</span>    <span class="dv">23</span>  <span class="fl">0.37</span> <span class="fl">0.342</span> <span class="fl">0.913</span>
 <span class="dv">3</span> Brian Card…   <span class="dv">2011</span>    <span class="dv">43</span>   <span class="dv">100</span>    <span class="dv">42</span>    <span class="dv">87</span>    <span class="dv">17</span>    <span class="dv">18</span>  <span class="fl">0.43</span> <span class="fl">0.483</span> <span class="fl">0.944</span>
 <span class="dv">4</span> Kyrylo Fes…   <span class="dv">2011</span>    <span class="dv">44</span>   <span class="dv">100</span>     <span class="dv">0</span>     <span class="dv">1</span>    <span class="dv">18</span>    <span class="dv">46</span>  <span class="fl">0.44</span> <span class="dv">0</span>     <span class="fl">0.391</span>
 <span class="dv">5</span> Jonathan B…   <span class="dv">2010</span>    <span class="dv">40</span>   <span class="dv">100</span>    <span class="dv">14</span>    <span class="dv">39</span>    <span class="dv">24</span>    <span class="dv">26</span>  <span class="fl">0.4</span>  <span class="fl">0.359</span> <span class="fl">0.923</span>
 <span class="dv">6</span> Ryan Bowen    <span class="dv">2008</span>    <span class="dv">49</span>   <span class="dv">100</span>     <span class="dv">0</span>     <span class="dv">1</span>    <span class="dv">16</span>    <span class="dv">29</span>  <span class="fl">0.49</span> <span class="dv">0</span>     <span class="fl">0.552</span>
 <span class="dv">7</span> Richie Fra…   <span class="dv">2006</span>    <span class="dv">39</span>   <span class="dv">100</span>    <span class="dv">23</span>    <span class="dv">70</span>     <span class="dv">7</span>    <span class="dv">10</span>  <span class="fl">0.39</span> <span class="fl">0.329</span> <span class="fl">0.7</span>  
 <span class="dv">8</span> Lindsey Hu…   <span class="dv">2006</span>    <span class="dv">37</span>   <span class="dv">100</span>    <span class="dv">11</span>    <span class="dv">43</span>     <span class="dv">2</span>     <span class="dv">4</span>  <span class="fl">0.37</span> <span class="fl">0.256</span> <span class="fl">0.5</span>  
 <span class="dv">9</span> Oliver Mil…   <span class="dv">2004</span>    <span class="dv">53</span>   <span class="dv">100</span>     <span class="dv">0</span>     <span class="dv">1</span>    <span class="dv">15</span>    <span class="dv">23</span>  <span class="fl">0.53</span> <span class="dv">0</span>     <span class="fl">0.652</span>
<span class="dv">10</span> Mark Jacks…   <span class="dv">2004</span>    <span class="dv">34</span>   <span class="dv">100</span>     <span class="dv">7</span>    <span class="dv">41</span>    <span class="dv">28</span>    <span class="dv">39</span>  <span class="fl">0.34</span> <span class="fl">0.171</span> <span class="fl">0.718</span>
<span class="co"># … with 6,296 more rows</span></code></pre></div>
<p>We can also filter on more complicated conditions constructed using the AND, OR, and NOT operators: <code>&amp;</code>, <code>|</code>, and <code>!</code>. For instance, to filter observations with at least 100 field goal attempts OR 50 three point attempts, we would do</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">filter</span>(raw_shooting, FGA &gt;=<span class="st"> </span><span class="dv">100</span> |<span class="st"> </span>TPA &gt;=<span class="st"> </span><span class="dv">50</span>)
<span class="co"># A tibble: 6,328 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Cu…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James Hard…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin Dura…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMarcus C…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBron Jam…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damian Lil…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Anthony Da…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russell We…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar DeRo…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul George   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 6,318 more rows</span></code></pre></div>
<p>We may combine these constraints by enclosing them in parantheses.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">filter</span>(raw_shooting, (FGA &gt;=<span class="st"> </span><span class="dv">100</span> &amp;<span class="st"> </span>TPA &gt;=<span class="st"> </span><span class="dv">50</span>) |<span class="st"> </span>(FGP &gt;=<span class="st"> </span><span class="fl">0.45</span> &amp;<span class="st"> </span>FGP &lt;=<span class="st"> </span><span class="fl">0.5</span>))
<span class="co"># A tibble: 4,837 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Cu…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James Hard…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin Dura…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMarcus C…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBron Jam…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damian Lil…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Anthony Da…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russell We…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar DeRo…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul George   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 4,827 more rows</span></code></pre></div>
<p>What if we wanted to pull out the observations corresponding to the 2015-16 and 2014-15 season. We could do something like <code>filter(raw_shooting, (SEASON == 2016) | (SEASON == 2015))</code>, which would be perfectly fine. However, what if we wanted data from 1998-99, 2011-12, and 2015-16? Typing a lot of expressions like <code>SEASON == ...</code> would be rather tedious. The <code>%in%</code> operator lets us avoid this tedium:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">filter</span>(raw_shooting, SEASON %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>, <span class="dv">2016</span>))
<span class="co"># A tibble: 1,150 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Cu…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James Hard…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin Dura…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMarcus C…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBron Jam…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damian Lil…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Anthony Da…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russell We…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar DeRo…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul George   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 1,140 more rows</span></code></pre></div>
<p>We could also filter out data from the two lockout-shortened seasons, 1998-99 and 2011-12 using a combination of the NOT <code>!</code> operator and <code>%in%</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">filter</span>(raw_shooting, !SEASON %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>))
<span class="co"># A tibble: 6,721 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Cu…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James Hard…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin Dura…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMarcus C…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBron Jam…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damian Lil…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Anthony Da…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russell We…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar DeRo…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul George   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 6,711 more rows</span></code></pre></div>
<p>For the remainder of this module, we will focus on the players who attempted at least 100 field goals, 100 free throws, 50 three pointers in the non-lockout seasons.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>nba_shooting_orig &lt;-<span class="st"> </span><span class="kw">filter</span>(raw_shooting, FGA &gt;=<span class="st"> </span><span class="dv">100</span> &amp;<span class="st"> </span>FTA &gt;=<span class="st"> </span><span class="dv">100</span> &amp;<span class="st"> </span>TPA &gt;=<span class="st"> </span><span class="dv">50</span> &amp;<span class="st"> </span>
+<span class="st">     </span>!SEASON %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2012</span>))
&gt;<span class="st"> </span>nba_shooting_orig
<span class="co"># A tibble: 2,254 x 11</span>
   PLAYER      SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">        </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Cu…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James Hard…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin Dura…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMarcus C…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBron Jam…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damian Lil…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Anthony Da…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russell We…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar DeRo…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul George   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 2,244 more rows</span></code></pre></div>
</div>
<div id="creating-new-variables-from-old" class="section level3">
<h3>Creating New Variables from Old</h3>
<p>In <a href="module1.html">Module 1</a>, we computed effective field goal percentage (eFGP), points scored (PTS), and true shooting percentage (TSP) from vectors containing the number of made and attempted field goals, three pointers, and free throws. Now that we have substantially more data stored in our tbl <code>nba_shooting_orig</code>, we would like to compute these statistics for all of the players and add new columns for them. We do this with <code>mutate()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">mutate</span>(nba_shooting_orig, <span class="dt">eFGP =</span> (FGM +<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>TPM)/FGA)
<span class="co"># A tibble: 2,254 x 12</span>
   PLAYER SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">   </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Steph…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMar…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBro…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damia…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Antho…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russe…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul …   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 2,244 more rows, and 1 more variable: eFGP &lt;dbl&gt;</span></code></pre></div>
<p>When we run the code above, we find that R prints out a tbl whose very last column is eFGP. However, if we try to print out <code>nba_shooting_orig</code> we no longer see this column! This is because dplyr functions never modify their input but work by creating a copy and modifying that. So if we wanted a new tbl that contains eFGP, we need to save it directly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>nba_shooting_2 &lt;-<span class="st"> </span><span class="kw">mutate</span>(nba_shooting_orig, <span class="dt">eFGP =</span> (FGM +<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>TPM)/FGA)
&gt;<span class="st"> </span>nba_shooting_2
<span class="co"># A tibble: 2,254 x 12</span>
   PLAYER SEASON   FGM   FGA   TPM   TPA   FTM   FTA   FGP   TPP   FTP
   &lt;chr&gt;<span class="st">   </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Steph…   <span class="dv">2016</span>   <span class="dv">805</span>  <span class="dv">1597</span>   <span class="dv">402</span>   <span class="dv">887</span>   <span class="dv">363</span>   <span class="dv">400</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span>
 <span class="dv">2</span> James…   <span class="dv">2016</span>   <span class="dv">710</span>  <span class="dv">1617</span>   <span class="dv">236</span>   <span class="dv">657</span>   <span class="dv">720</span>   <span class="dv">837</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span>
 <span class="dv">3</span> Kevin…   <span class="dv">2016</span>   <span class="dv">698</span>  <span class="dv">1381</span>   <span class="dv">186</span>   <span class="dv">480</span>   <span class="dv">447</span>   <span class="dv">498</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span>
 <span class="dv">4</span> DeMar…   <span class="dv">2016</span>   <span class="dv">601</span>  <span class="dv">1332</span>    <span class="dv">70</span>   <span class="dv">210</span>   <span class="dv">476</span>   <span class="dv">663</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span>
 <span class="dv">5</span> LeBro…   <span class="dv">2016</span>   <span class="dv">737</span>  <span class="dv">1416</span>    <span class="dv">87</span>   <span class="dv">282</span>   <span class="dv">359</span>   <span class="dv">491</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span>
 <span class="dv">6</span> Damia…   <span class="dv">2016</span>   <span class="dv">618</span>  <span class="dv">1474</span>   <span class="dv">229</span>   <span class="dv">610</span>   <span class="dv">414</span>   <span class="dv">464</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span>
 <span class="dv">7</span> Antho…   <span class="dv">2016</span>   <span class="dv">560</span>  <span class="dv">1137</span>    <span class="dv">35</span>   <span class="dv">108</span>   <span class="dv">326</span>   <span class="dv">430</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span>
 <span class="dv">8</span> Russe…   <span class="dv">2016</span>   <span class="dv">656</span>  <span class="dv">1444</span>   <span class="dv">101</span>   <span class="dv">341</span>   <span class="dv">465</span>   <span class="dv">573</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span>
 <span class="dv">9</span> DeMar…   <span class="dv">2016</span>   <span class="dv">614</span>  <span class="dv">1377</span>    <span class="dv">47</span>   <span class="dv">139</span>   <span class="dv">555</span>   <span class="dv">653</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span>
<span class="dv">10</span> Paul …   <span class="dv">2016</span>   <span class="dv">605</span>  <span class="dv">1448</span>   <span class="dv">210</span>   <span class="dv">565</span>   <span class="dv">454</span>   <span class="dv">528</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span>
<span class="co"># … with 2,244 more rows, and 1 more variable: eFGP &lt;dbl&gt;</span></code></pre></div>
<p>We now have a new tbl in our environment called <code>nba_shooting_2</code> and this new tbl now has a column for eFGP. Recall that the formulas for points scored (PTS) and true shooting percentage (TSP): <span class="math display">\[
\text{PTS} = \text{FTM} + 2\times \text{FGM} + \text{TPM}
\]</span> <span class="math display">\[
\text{TSP} = \frac{\text{PTS}}{2\times(\text{FGA} + 0.44\times \text{FTA})}
\]</span> We can add both of them to our tbl using <code>mutate()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>nba_shooting_3 &lt;-<span class="st"> </span><span class="kw">mutate</span>(nba_shooting_2, <span class="dt">PTS =</span> FTM +<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>FGM +<span class="st"> </span>TPM)
&gt;<span class="st"> </span>nba_shooting_4 &lt;-<span class="st"> </span><span class="kw">mutate</span>(nba_shooting_3, <span class="dt">TSP =</span> PTS/(<span class="dv">2</span> *<span class="st"> </span>(FGA +<span class="st"> </span><span class="fl">0.44</span> *<span class="st"> </span>FTA)))</code></pre></div>
<p>Compared to <code>nba_shooting_orig</code>, the tbl <code>nba_shooting_4</code> now has three additional columns for eFGP, PTS, and TPS. In order to create this tbl, we created two intermdiate tbls, <code>nba_shooting_2</code> and <code>nba_shooting_3</code>. These are somewhat useless now, since any analyses we would want to do with them could be done using the richer dataset in <code>nba_shooting_4</code>.</p>
<p>To get rid of these objects, we can use the <code>rm()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">rm</span>(nba_shooting_2, nba_shooting_3)</code></pre></div>
<p><code>rm()</code> works by deleting the objects whose names are specified within the parantheses and separated by parantheses.</p>
<p>If you’re thinking that it was somewhat inefficient to create the two intermediate tbls <code>nba_shooting_2</code> and <code>nba_shooting_3</code> in order to arrive at <code>nba_shooting_4</code>, you’re correct. It turns out that we could have done it all in one shot, as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>nba_shooting &lt;-<span class="st"> </span><span class="kw">mutate</span>(nba_shooting_orig, 
+<span class="st">                          </span><span class="dt">eFGP =</span> (FGM +<span class="st"> </span><span class="fl">0.5</span>*TPM)/FGA,
+<span class="st">                          </span><span class="dt">PTS =</span> FTM +<span class="st"> </span><span class="dv">2</span>*FGM +<span class="st"> </span>TPM,
+<span class="st">                          </span><span class="dt">TSP =</span> PTS/(<span class="dv">2</span> *<span class="st"> </span>(FGA +<span class="st"> </span><span class="fl">0.44</span> *<span class="st"> </span>FTA)))</code></pre></div>
<p>You’ll notice in this code that we have separated each variable we’re creating onto its own line. This helps make the code readable.</p>
<p>When we print both <code>nba_shooting_4</code> and <code>nba_shooting</code>, we see that the first ten rows are identical. To verify that the remaining 2,413 rows are identical, we can use R’s <code>identical()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">identical</span>(nba_shooting, nba_shooting_4)
[<span class="dv">1</span>] <span class="ot">TRUE</span></code></pre></div>
<div id="creating-categorical-variables" class="section level4">
<h4>Creating Categorical Variables</h4>
<p>So far, we have used <code>mutate()</code> to compute numeric or continuous variables. Often in an analysis, however, we may want to <em>bin</em> these values into smaller buckets or categories. For instance, we may rather arbitrarily classify players based on their three-point shooting prowess as follows:</p>
<ul>
<li>Hopeless: TPP &lt; 20%</li>
<li>Below Average: 20% &lt;= TPP &lt; 30%</li>
<li>Average: 30% &lt;= TPP &lt; 35%</li>
<li>Above Average: 35% &lt; TPP &lt; 40%</li>
<li>Elite: TPP &gt; 40%</li>
</ul>
<p>In order to add a column to <code>nba_shooting</code> that includes these classifications, we can use the <code>case_when()</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>nba_shooting &lt;-<span class="st"> </span><span class="kw">mutate</span>(nba_shooting,
+<span class="st">                        </span><span class="dt">Classification =</span> <span class="kw">case_when</span>(
+<span class="st">                          </span>TPP &lt;<span class="st"> </span><span class="fl">0.2</span> ~<span class="st">  &quot;Hopeless&quot;</span>,
+<span class="st">                          </span><span class="fl">0.2</span> &lt;=<span class="st"> </span>TPP &amp;<span class="st"> </span>TPP &lt;<span class="st"> </span><span class="fl">0.3</span> ~<span class="st"> &quot;Below Average&quot;</span>,
+<span class="st">                          </span><span class="fl">0.3</span> &lt;=<span class="st"> </span>TPP &amp;<span class="st"> </span>TPP &lt;<span class="st"> </span><span class="fl">0.35</span> ~<span class="st">  &quot;Average&quot;</span>,
+<span class="st">                          </span><span class="fl">0.35</span> &lt;=<span class="st"> </span>TPP &amp;<span class="st"> </span>TPP &lt;<span class="st"> </span><span class="fl">0.4</span> ~<span class="st"> &quot;Above Average&quot;</span>,
+<span class="st">                          </span><span class="fl">0.4</span> &lt;=<span class="st"> </span>TPP ~<span class="st"> &quot;Elite&quot;</span>))</code></pre></div>
<p>Let’s take a minute to unpack the code above. Within <code>mutate()</code>, we have started like we always did, with the name of the new variable on the left hand side of an equal sign. Then we called the <code>case_when()</code> function. Within this function, we have a new line for each of the values of the new variable <code>Classification''. On each line we have an expression with a twiddle (`~`). On the left of the `~`, we have put a logical expression and on the right we have written the value of</code>Clasification’’.</p>
</div>
</div>
<div id="summarizing-individual-columns" class="section level3">
<h3>Summarizing Individual Columns</h3>
<p>Among eligible players, what was the average field goal percentage in the 2015-16 season? To answer this, we can use <code>filter()</code> to create a new tbl containing the data only for this season. Then we can use the dplyr verb <code>summarize()</code> as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span>nba_shooting_2016 &lt;-<span class="st"> </span><span class="kw">filter</span>(nba_shooting, SEASON ==<span class="st"> </span><span class="dv">2016</span>)
&gt;<span class="st"> </span><span class="kw">summarize</span>(nba_shooting_2016, <span class="dt">FGP =</span> <span class="kw">mean</span>(FGP))
<span class="co"># A tibble: 1 x 1</span>
    FGP
  &lt;dbl&gt;
<span class="dv">1</span> <span class="fl">0.438</span>
&gt;<span class="st"> </span><span class="kw">summarize</span>(nba_shooting_2016, <span class="dt">FGP =</span> <span class="kw">mean</span>(FGP), <span class="dt">TPP =</span> <span class="kw">mean</span>(TPP), <span class="dt">FTP =</span> <span class="kw">mean</span>(FTP))
<span class="co"># A tibble: 1 x 3</span>
    FGP   TPP   FTP
  &lt;dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="dv">1</span> <span class="fl">0.438</span> <span class="fl">0.346</span> <span class="fl">0.790</span></code></pre></div>
<p>In the first example, we compute the average field goal percentage and in the second example, we compute the average field goal, three point, and free throw percentages. Of course, we are not limited to computing just the mean. The following functions are quite useful for summarizing several aspects of the distribution of the variables in our dataset:</p>
<ul>
<li>Center: <code>mean()</code>, <code>median()</code></li>
<li>Spread: <code>sd()</code>, <code>IQR()</code></li>
<li>Range: <code>min()</code>, <code>max()</code></li>
<li>Count: <code>n()</code>, <code>n_distinct()</code></li>
</ul>
<p>We will have much more to say about <code>summarize()</code> in <a href="module4.html">Module 4</a> when we discuss grouped manipulations. <!-- Need some examples here --></p>
</div>
<div id="selecting-columns" class="section level3">
<h3>Selecting Columns</h3>
<p>Oftentimes, the dataset you load into R contains many, many more columns than you need. We can use <code>select()</code> to pull out the columns we want to use in our subsequent analyses. For instance, we may want to only focus on the columns SEASON, FGP, TPP, FTP, eFGP, PTS, and TSP and ignore the rest of the columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">select</span>(nba_shooting, PLAYER, SEASON, FGP, TPP, FTP, eFGP, PTS, TSP)
<span class="co"># A tibble: 2,254 x 8</span>
   PLAYER            SEASON   FGP   TPP   FTP  eFGP   PTS   TSP
   &lt;chr&gt;<span class="st">              </span><span class="er">&lt;</span>int&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;<span class="st"> </span><span class="er">&lt;</span>dbl&gt;
<span class="st"> </span><span class="dv">1</span> Stephen Curry       <span class="dv">2016</span> <span class="fl">0.504</span> <span class="fl">0.453</span> <span class="fl">0.908</span> <span class="fl">0.630</span>  <span class="dv">2375</span> <span class="fl">0.670</span>
 <span class="dv">2</span> James Harden        <span class="dv">2016</span> <span class="fl">0.439</span> <span class="fl">0.359</span> <span class="fl">0.860</span> <span class="fl">0.512</span>  <span class="dv">2376</span> <span class="fl">0.598</span>
 <span class="dv">3</span> Kevin Durant        <span class="dv">2016</span> <span class="fl">0.505</span> <span class="fl">0.388</span> <span class="fl">0.898</span> <span class="fl">0.573</span>  <span class="dv">2029</span> <span class="fl">0.634</span>
 <span class="dv">4</span> DeMarcus Cousins    <span class="dv">2016</span> <span class="fl">0.451</span> <span class="fl">0.333</span> <span class="fl">0.718</span> <span class="fl">0.477</span>  <span class="dv">1748</span> <span class="fl">0.538</span>
 <span class="dv">5</span> LeBron James        <span class="dv">2016</span> <span class="fl">0.520</span> <span class="fl">0.309</span> <span class="fl">0.731</span> <span class="fl">0.551</span>  <span class="dv">1920</span> <span class="fl">0.588</span>
 <span class="dv">6</span> Damian Lillard      <span class="dv">2016</span> <span class="fl">0.419</span> <span class="fl">0.375</span> <span class="fl">0.892</span> <span class="fl">0.497</span>  <span class="dv">1879</span> <span class="fl">0.560</span>
 <span class="dv">7</span> Anthony Davis       <span class="dv">2016</span> <span class="fl">0.493</span> <span class="fl">0.324</span> <span class="fl">0.758</span> <span class="fl">0.508</span>  <span class="dv">1481</span> <span class="fl">0.558</span>
 <span class="dv">8</span> Russell Westbrook   <span class="dv">2016</span> <span class="fl">0.454</span> <span class="fl">0.296</span> <span class="fl">0.812</span> <span class="fl">0.489</span>  <span class="dv">1878</span> <span class="fl">0.554</span>
 <span class="dv">9</span> DeMar DeRozan       <span class="dv">2016</span> <span class="fl">0.446</span> <span class="fl">0.338</span> <span class="fl">0.850</span> <span class="fl">0.463</span>  <span class="dv">1830</span> <span class="fl">0.550</span>
<span class="dv">10</span> Paul George         <span class="dv">2016</span> <span class="fl">0.418</span> <span class="fl">0.372</span> <span class="fl">0.860</span> <span class="fl">0.490</span>  <span class="dv">1874</span> <span class="fl">0.558</span>
<span class="co"># … with 2,244 more rows</span></code></pre></div>
</div>
<div id="saving-our-work" class="section level2">
<h2>Saving our work</h2>
<p>By this point, the <code>nba_shooting</code> tbl has much more information in it than the original data file we read in. While we can always re-run the commands used to produce this tbl from our script, when data analyses become more complicated, it is helpful to save these objects. R has its own special file format for efficiently saving data on your computer.</p>
<p>We will use the <code>save()</code> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">save</span>(nba_shooting, <span class="dt">file =</span> <span class="st">&quot;data/nba_shooting.RData&quot;</span>)</code></pre></div>
<p>When we want to <em>load</em> the data back into R, we can use the <code>load()</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">load</span>(<span class="st">&quot;data/nba_shooting.RData&quot;</span>)</code></pre></div>
</div>
<div id="thinking-ahead-for-tomorrow" class="section level2">
<h2>Thinking Ahead for Tomorrow</h2>
<p>Up to this point, we have only used the dplyr verbs <code>mutate()</code>, <code>filter()</code>, and <code>arrange()</code> one at a time. What if we wanted to do something a bit more complicated like:</p>
<ol style="list-style-type: decimal">
<li>Remove players from the lockout season who had fewer than 100 field goal attempts, fewer than 100 free throw attempts, or fewer than 50 three point attempts</li>
<li>Arrange them according to their three point percentage.</li>
<li>Add a classification of their three point shooting ability (as we did above with <code>case_when()</code>)</li>
<li>Compute the mean field goal percentage of all of the players within each of these categories. That is, separately compute the mean field goal percentage of the “Elite” three point shooters, the “Above Average” three point shooters, etc.</li>
</ol>
<p>Using what we have already learned, you could accomplish steps 1 – 3 by creating lots of temporary tbls. In <a href="module4.html">Module 4</a>, we will learn how to string together several dplyr verbs to perform the above tasks without having to create temporary tbls. We will also learn how to perform grouped calculations. <!-- need to include some more examples here --></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
